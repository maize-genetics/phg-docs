
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../CreatePHG_step1_loadGenomeIntervals/">
      
      
        <link rel="next" href="../CreatePHG_step2_FilterGVCFPlugin/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.13">
    
    
      
        <title>Step 2: Add haplotypes to a database - Practical Haplotype Graph Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#step-2-add-haplotypes-to-a-database" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Practical Haplotype Graph Documentation" class="md-header__button md-logo" aria-label="Practical Haplotype Graph Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Practical Haplotype Graph Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Step 2: Add haplotypes to a database
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Practical Haplotype Graph Documentation" class="md-nav__button md-logo" aria-label="Practical Haplotype Graph Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Practical Haplotype Graph Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Home_variantTables/" class="md-nav__link">
        How to use the PHG
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Home_variantsInGVCFFiles/" class="md-nav__link">
        How to use the PHG
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Home_version1/" class="md-nav__link">
        Home version1
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../PHG_GUI/" class="md-nav__link">
        Documentation for Genotyping using the PHG within TASSEL GUI
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          PHG 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          PHG 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../PHG%20/%20BrAPI%20Server%20on%20CBSU/" class="md-nav__link">
         BrAPI Server on CBSU
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Pipeline version1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Pipeline version1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/AssemblyHaplotypesPlugin/" class="md-nav__link">
        AssemblyHaplotypesPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/ConfigFile/" class="md-nav__link">
        ConfigFile Documentation #
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateAssemblyAnchorsPlugin/" class="md-nav__link">
        CreateAssemblyAnchorsPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateConsensi/" class="md-nav__link">
        CreateConsensi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateHaplotypeKeyFile/" class="md-nav__link">
        CreateHaplotype Key File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateHaplotypes/" class="md-nav__link">
        Create Haplotypes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateHaplotypesFromBAM/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateHaplotypesFromFastq/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateHaplotypesFromGVCF/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateReferenceIntervals/" class="md-nav__link">
        CreateReferenceIntervals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/ExportPath/" class="md-nav__link">
        ExportPath
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FastqToHapCountPlugin/" class="md-nav__link">
        FastqToHapCountPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FilterGVCFPlugin/" class="md-nav__link">
        FilterGVCFPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FindHaplotypeClustersPlugin/" class="md-nav__link">
        FindHaplotypeClustersPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FindPath/" class="md-nav__link">
        FindPath
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FindPathKeyFiles/" class="md-nav__link">
        Find Path Key Files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FindPathMinimap2/" class="md-nav__link">
        Overview #
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/HapCountBestPathToTextPlugin/" class="md-nav__link">
        HapCountBestPathToTextPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/ImportHaplotypePathFilePlugin/" class="md-nav__link">
        ImportHaplotypePathFilePlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/ImportReadMappingToDBPlugin/" class="md-nav__link">
        ImportReadMappingToDBPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/IndexPangenome/" class="md-nav__link">
        Overview #
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/LoadAssemblyAnchors/" class="md-nav__link">
        LoadAssemblyAnchors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/LoadConsensusAnchorSequencesPlugin/" class="md-nav__link">
        LoadConsensusAnchorSequencesPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/LoadGenomeIntervals/" class="md-nav__link">
        LoadGenomeIntervals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/LoadGenomeIntervalsToDBPlugin/" class="md-nav__link">
        LoadGenomeIntervalsToDBPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/LoadHapSequencesToDBPlugin/" class="md-nav__link">
        LoadHapSequencesToDBPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/MergeGVCFPlugin/" class="md-nav__link">
        MergeGVCFPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/Minimap2NoDocker/" class="md-nav__link">
        Minimap2NoDocker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/PHG_Liquibase/" class="md-nav__link">
        PHG Liquibase
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/PHG_PostgresDocker/" class="md-nav__link">
        PHG PostgresDocker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/ParallelAssemblyAnchorsLoad/" class="md-nav__link">
        ParallelAssemblyAnchorsLoad
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/PathsToVCFPlugin/" class="md-nav__link">
        PathsToVCFPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/RunHapCollapsePlugin/" class="md-nav__link">
        RunHapCollapsePlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/SAMToMappingPlugin/" class="md-nav__link">
        SAMToMappingPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/help_biostars/" class="md-nav__link">
        How to ask questions about the PHG
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_36" >
      
      
      
        <label class="md-nav__link" for="__nav_7_36" id="__nav_7_36_label" tabindex="0">
          DeprecatedScripts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_36_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_36">
          <span class="md-nav__icon md-icon"></span>
          DeprecatedScripts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/DeprecatedScripts/CreateHaplotypes_sh/" class="md-nav__link">
        THIS SCRIPT IS DEPRECATED
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          UserInstructions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          UserInstructions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step0_conda/" class="md-nav__link">
        Use Conda to run PHG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step0_docker/" class="md-nav__link">
        Use Docker to run PHG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step0_main/" class="md-nav__link">
        CreatePHG step0 main
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step0_singularity/" class="md-nav__link">
        Use Singularity to run PHG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step1-2_main/" class="md-nav__link">
        Create and Populate a PHG database with haplotypes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step1CreateDB_loadRef/" class="md-nav__link">
        Create and Populate a PHG database with haplotypes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step1_bedfile/" class="md-nav__link">
        Create bedfile of intervals for PHG reference ranges
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step1_groupGenomeIntervals/" class="md-nav__link">
        Separate genome intervals into different groups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step1_loadGenomeIntervals/" class="md-nav__link">
        Load genome intervals to PHG
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Step 2: Add haplotypes to a database
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_FilterGVCFPlugin/" class="md-nav__link">
        Filter GVCF Plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_FilterGVCFSingleFilePlugin/" class="md-nav__link">
        FilterGVCFSingleFilePlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_LoadHaplotypesFromGVCFPluginDetails/" class="md-nav__link">
        LoadHaplotypesFromGVCFPlugin Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_MAFToGVCFPluginDetails/" class="md-nav__link">
        MAFToGVCFPlugin Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_addHaplotypesFromWGS/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_addHapsFromBAM/" class="md-nav__link">
        Separate genome intervals into groups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_addHapsFromFastq/" class="md-nav__link">
        Align WGS fastq files to reference genome
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_addHapsFromGVCF/" class="md-nav__link">
        Filter GVCF and add variants to database
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_alignAssemblies/" class="md-nav__link">
        Align assemblies to reference genome
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_assemblyAnchorWavePluginDetails/" class="md-nav__link">
        AssemblyMAFFromAnchorWavePlugin Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_assemblyHaplotypeParameters/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_assemblyViaAnchorwave/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_consensus/" class="md-nav__link">
        Create consensus haplotypes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_haplotypeKeyfile/" class="md-nav__link">
        CreateHaplotype Key File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_taxaGroupTables/" class="md-nav__link">
        Separate taxa  into different groups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ExampleDatabase/" class="md-nav__link">
        Creating a Simple Example Database
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../FindLikelyParents/" class="md-nav__link">
        Finding Likely Parents for Imputation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../HaplotypeMethod/" class="md-nav__link">
        Haplotype Methods
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputePHG_Simple/" class="md-nav__link">
        I have a fastq file - I want a PHG path
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_VCF/" class="md-nav__link">
        Impute variants from a VCF file
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_compare/" class="md-nav__link">
        Compare PHG variants to existing variants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_exportVCF/" class="md-nav__link">
        Export variants as VCF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_extractPangenome/" class="md-nav__link">
        Extract a pangenome fasta file
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_fastq-heterozygous/" class="md-nav__link">
        Impute variants from any fastq file
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_fastq-homozygous/" class="md-nav__link">
        Impute variants from any fastq file - process for homozygous individuals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_findPathKeyFiles/" class="md-nav__link">
        Find Path Key Files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_main/" class="md-nav__link">
        ImputeWithPHG main
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_paramTuning/" class="md-nav__link">
        Tune pathfinding parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MakeDefaultDirectory/" class="md-nav__link">
        Make Default Directory Plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MakeInitialPHGDBPipeline/" class="md-nav__link">
        Make Initial PHG DB Pipeline Plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MergeFastqPluginDetailedDocs/" class="md-nav__link">
        MergeFastqPlugin Detailed Documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MultisampleBAMPipeline/" class="md-nav__link">
        Step 3a: Create ReadMappings using the MultisampleBAM Pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../PopulatePHGDBPipeline/" class="md-nav__link">
        Populate PHG DB Pipeline Plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../SampleHaplotypeConfigFile/" class="md-nav__link">
        Sample Config file for Loading Haplotypes.
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UpdatePHGSchema/" class="md-nav__link">
        Update an existing PHG database to latest schema with liquibase
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../help_biostars/" class="md-nav__link">
        How to ask questions about the PHG
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="step-2-add-haplotypes-to-a-database">Step 2: Add haplotypes to a database</h1>
<p><img alt="CreateAndPopulatePHGDatabase_step2.png" src="../../images/CreatePHG_step2.png" /></p>
<h1 id="step-2-pipeline-includes-several-individual-steps-some-of-which-may-be-run-in-parallel">Step 2 pipeline includes several individual steps, some of which may be run in parallel.</h1>
<p>All PHG haplotypes are created from GVCF files.  The recommended method of creating these GVCF files is by aligning assemblies to a reference genome and converting the output to bgzipped GVCF files along with a tabix'd version of the bgzipped file.  Using assemblies provides for more complete haplotypes and better calling of long indels.  However, not every species has multiple assembled genomes. For those species, GVCF files created by aligning WGS fastq files to a reference genome may be used to create PHG haplotypes. In both cases, GVCF files are the vehicle for creating the PHG haplotypes.</p>
<p><strong> Important: </strong> A GVCF file contains more information than a regular VCF file. We use the <a href="https://gatk.broadinstitute.org/hc/en-us/articles/360035531812-GVCF-Genomic-Variant-Call-Format">GATK GVCF format</a> for the PHG.</p>
<p><img alt="CreateAndPopulateFromGVCF_step2.png" src="../../images/LoadGVCF_withServer.png" /></p>
<p>The major architectural difference between PHG version 1 and the versions that preceded it is in the storage of haplotype variant information.  In previous releases, these variants were stored in the database, originally in the haplotypes table, and in later versions, in their own table.  While it was convenient to have all data stored in the database, these tables became very large and adversely affected database performance. As the number of variants increased, the processing time involving these variants also increased, often to levels where processing hung.</p>
<p>To counter-act this behavior, we made the decision to store all variant information in the original gvcf files external to the database, but optionally on the same server.  There will be 2 files stored for each genome:  a bgzipped version of the gvcf, and a tabix'd version of the bgzipped file.  While this requires a bit more work on the part of the user, it greatly increases processing speed in the PHG while allowing variants to be stored in a standard format compatible for processing with other bioinformatics applications.</p>
<p>When loading the haplotypes, the user specifies via parameters the location of the external gvcf folder.  This data is then stored to the PHG database table "genome_file_data".  Once haplotypes have been created and stored from the gvcfs files, the user must arrange for these files to be stored to an accessible, central location as specified by the gvcfServerDir parameter.  Prior to running any PHG code that requires haplotype variant information, the user must download the gvcf files (<em>.gz and </em>.gz.tbi files) to the local server where data processing will occur.  </p>
<p>A new "localGVCFFolder" parameter that holds the local location of these files is now required in the following plugins.  This parameter is used for accessing the files when variant information is requested:</p>
<ul>
<li>HaplotypeGraphBuilderPlugin</li>
<li>HaplotypeGraphStreamBuilderPlugin</li>
<li>ImputePipelinePlugin</li>
<li>MakeInitialPHGDBPipelinePlugin</li>
<li>PopulatePHGDBPlugin (we do not recommend the use of this plugin)</li>
</ul>
<p>The "gvcfServerPath" column must be in the keyfiles that are passed as parameters to the following plugins/functions.  This value is stored to the PHG genome_file_data table where it records the server/path where these files are stored externally. This is expected to be the more "permanent" home for these files, and is the link from which a user will download the files to his local server:</p>
<ul>
<li>LoadAllIntervalsToPHGdbPlugin (new column in the file sent as the "genomeData" parameter)</li>
<li>LaodHaplotypesFromGVCFPlugin (new column in the file sent as the "wgsKeyFile" parameter)</li>
<li>PopulatePHGDBPipelinePlugin (parameter used when creating the gvcf key file - note, we do not recommend using this plugin)</li>
</ul>
<p><strong> A. Align assemblies to reference genome, add to DB. </strong></p>
<p>Any alignment method may be used to create the GVCF files needed for loading haplotypes to the PHG database.  We recommend using the <a href="https://www.pnas.org/doi/10.1073/pnas.2113075119">anchorwave program</a> for genome alignment.  Anchorwave alignment can be memory and processing intensive but the quality of alignment has been shown to be superior to other alignment methods. Anchorwave can take up to 50G per thread when aligning a single genome.  We recommend you run your alignments separately on one or more machines, convert the resulting MAF files to bgzipped/tabix'd GVCF files, then copy these files (both the bgzipped and tabix'd versions) to the machine from which you will load your database. </p>
<p>Processing alignments via mummer4 is available in previous editions of the PHG software, but not with the new versions that process GVCF files into haplotypes.  Should you wish to continue to use mummer4, you can align outside of the pipeline software, and use a tool e.g. <a href="https://www.biostars.org/p/395210/">mummer-2-vcf</a> for conversion.</p>
<p>Specifics on running anchorwave through the PHG pipeline are described below</p>
<ol>
<li><a href="../CreatePHG_step2_assemblyViaAnchorwave/">Align assemblies using anchorwave aligner</a></li>
</ol>
<p><strong> B. Create haplotypes from WGS fastq files </strong></p>
<ol>
<li>
<p><a href="../CreatePHG_step2_addHapsFromFastq/">Align WGS fastq files to reference genome</a></p>
</li>
<li>
<p><a href="../CreatePHG_step2_addHapsFromBAM/">Call variants from BAM file</a></p>
</li>
<li>
<p><a href="../CreatePHG_step2_addHapsFromGVCF/">Filter GVCF, add to database</a></p>
</li>
</ol>
<p><strong> C. Creating consensus </strong></p>
<ol>
<li><a href="../CreatePHG_step2_consensus/">Create consensus haplotypes</a></li>
</ol>
<p><strong> D.  Optional: group your PHG taxa </strong></p>
<ol>
<li><a href="../CreatePHG_step2_taxaGroupTables/">Optionally, set up groups of PHG taxa</a></li>
</ol>
<p><a href="../../Home_variantsInGVCFFiles/">Return to PHG version 1.0 Home </a></p>
<p><a href="../Home.md">Return to Wiki Home</a></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>