
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../ImputeWithPHG_fastq-heterozygous/">
      
      
        <link rel="next" href="../ImputeWithPHG_findPathKeyFiles/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.13">
    
    
      
        <title>Impute variants from any fastq file - process for homozygous individuals - Practical Haplotype Graph Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#impute-variants-from-any-fastq-file-process-for-homozygous-individuals" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Practical Haplotype Graph Documentation" class="md-header__button md-logo" aria-label="Practical Haplotype Graph Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Practical Haplotype Graph Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Impute variants from any fastq file - process for homozygous individuals
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Practical Haplotype Graph Documentation" class="md-nav__button md-logo" aria-label="Practical Haplotype Graph Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Practical Haplotype Graph Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Home_variantTables/" class="md-nav__link">
        How to use the PHG
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Home_variantsInGVCFFiles/" class="md-nav__link">
        How to use the PHG
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Home_version1/" class="md-nav__link">
        Home version1
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../PHG_GUI/" class="md-nav__link">
        Documentation for Genotyping using the PHG within TASSEL GUI
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          PHG 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          PHG 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../PHG%20/%20BrAPI%20Server%20on%20CBSU/" class="md-nav__link">
         BrAPI Server on CBSU
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Pipeline version1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Pipeline version1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/AssemblyHaplotypesPlugin/" class="md-nav__link">
        AssemblyHaplotypesPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/ConfigFile/" class="md-nav__link">
        ConfigFile Documentation #
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateAssemblyAnchorsPlugin/" class="md-nav__link">
        CreateAssemblyAnchorsPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateConsensi/" class="md-nav__link">
        CreateConsensi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateHaplotypeKeyFile/" class="md-nav__link">
        CreateHaplotype Key File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateHaplotypes/" class="md-nav__link">
        Create Haplotypes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateHaplotypesFromBAM/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateHaplotypesFromFastq/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateHaplotypesFromGVCF/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/CreateReferenceIntervals/" class="md-nav__link">
        CreateReferenceIntervals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/ExportPath/" class="md-nav__link">
        ExportPath
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FastqToHapCountPlugin/" class="md-nav__link">
        FastqToHapCountPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FilterGVCFPlugin/" class="md-nav__link">
        FilterGVCFPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FindHaplotypeClustersPlugin/" class="md-nav__link">
        FindHaplotypeClustersPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FindPath/" class="md-nav__link">
        FindPath
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FindPathKeyFiles/" class="md-nav__link">
        Find Path Key Files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/FindPathMinimap2/" class="md-nav__link">
        Overview #
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/HapCountBestPathToTextPlugin/" class="md-nav__link">
        HapCountBestPathToTextPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/ImportHaplotypePathFilePlugin/" class="md-nav__link">
        ImportHaplotypePathFilePlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/ImportReadMappingToDBPlugin/" class="md-nav__link">
        ImportReadMappingToDBPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/IndexPangenome/" class="md-nav__link">
        Overview #
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/LoadAssemblyAnchors/" class="md-nav__link">
        LoadAssemblyAnchors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/LoadConsensusAnchorSequencesPlugin/" class="md-nav__link">
        LoadConsensusAnchorSequencesPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/LoadGenomeIntervals/" class="md-nav__link">
        LoadGenomeIntervals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/LoadGenomeIntervalsToDBPlugin/" class="md-nav__link">
        LoadGenomeIntervalsToDBPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/LoadHapSequencesToDBPlugin/" class="md-nav__link">
        LoadHapSequencesToDBPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/MergeGVCFPlugin/" class="md-nav__link">
        MergeGVCFPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/Minimap2NoDocker/" class="md-nav__link">
        Minimap2NoDocker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/PHG_Liquibase/" class="md-nav__link">
        PHG Liquibase
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/PHG_PostgresDocker/" class="md-nav__link">
        PHG PostgresDocker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/ParallelAssemblyAnchorsLoad/" class="md-nav__link">
        ParallelAssemblyAnchorsLoad
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/PathsToVCFPlugin/" class="md-nav__link">
        PathsToVCFPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/RunHapCollapsePlugin/" class="md-nav__link">
        RunHapCollapsePlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/SAMToMappingPlugin/" class="md-nav__link">
        SAMToMappingPlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/help_biostars/" class="md-nav__link">
        How to ask questions about the PHG
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_36" >
      
      
      
        <label class="md-nav__link" for="__nav_7_36" id="__nav_7_36_label" tabindex="0">
          DeprecatedScripts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_36_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_36">
          <span class="md-nav__icon md-icon"></span>
          DeprecatedScripts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pipeline_version1/DeprecatedScripts/CreateHaplotypes_sh/" class="md-nav__link">
        THIS SCRIPT IS DEPRECATED
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          UserInstructions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          UserInstructions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step0_conda/" class="md-nav__link">
        Use Conda to run PHG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step0_docker/" class="md-nav__link">
        Use Docker to run PHG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step0_main/" class="md-nav__link">
        CreatePHG step0 main
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step0_singularity/" class="md-nav__link">
        Use Singularity to run PHG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step1-2_main/" class="md-nav__link">
        Create and Populate a PHG database with haplotypes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step1CreateDB_loadRef/" class="md-nav__link">
        Create and Populate a PHG database with haplotypes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step1_bedfile/" class="md-nav__link">
        Create bedfile of intervals for PHG reference ranges
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step1_groupGenomeIntervals/" class="md-nav__link">
        Separate genome intervals into different groups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step1_loadGenomeIntervals/" class="md-nav__link">
        Load genome intervals to PHG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2AssemblyAndWGSHaplotypes/" class="md-nav__link">
        Step 2: Add haplotypes to a database
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_FilterGVCFPlugin/" class="md-nav__link">
        Filter GVCF Plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_FilterGVCFSingleFilePlugin/" class="md-nav__link">
        FilterGVCFSingleFilePlugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_LoadHaplotypesFromGVCFPluginDetails/" class="md-nav__link">
        LoadHaplotypesFromGVCFPlugin Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_MAFToGVCFPluginDetails/" class="md-nav__link">
        MAFToGVCFPlugin Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_addHaplotypesFromWGS/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_addHapsFromBAM/" class="md-nav__link">
        Separate genome intervals into groups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_addHapsFromFastq/" class="md-nav__link">
        Align WGS fastq files to reference genome
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_addHapsFromGVCF/" class="md-nav__link">
        Filter GVCF and add variants to database
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_alignAssemblies/" class="md-nav__link">
        Align assemblies to reference genome
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_assemblyAnchorWavePluginDetails/" class="md-nav__link">
        AssemblyMAFFromAnchorWavePlugin Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_assemblyHaplotypeParameters/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_assemblyViaAnchorwave/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_consensus/" class="md-nav__link">
        Create consensus haplotypes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_haplotypeKeyfile/" class="md-nav__link">
        CreateHaplotype Key File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CreatePHG_step2_taxaGroupTables/" class="md-nav__link">
        Separate taxa  into different groups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ExampleDatabase/" class="md-nav__link">
        Creating a Simple Example Database
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../FindLikelyParents/" class="md-nav__link">
        Finding Likely Parents for Imputation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../HaplotypeMethod/" class="md-nav__link">
        Haplotype Methods
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputePHG_Simple/" class="md-nav__link">
        I have a fastq file - I want a PHG path
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_VCF/" class="md-nav__link">
        Impute variants from a VCF file
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_compare/" class="md-nav__link">
        Compare PHG variants to existing variants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_exportVCF/" class="md-nav__link">
        Export variants as VCF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_extractPangenome/" class="md-nav__link">
        Extract a pangenome fasta file
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_fastq-heterozygous/" class="md-nav__link">
        Impute variants from any fastq file
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Impute variants from any fastq file - process for homozygous individuals
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Impute variants from any fastq file - process for homozygous individuals
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    Quick Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#details" class="md-nav__link">
    Details
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kitchen-sink" class="md-nav__link">
    Kitchen Sink
  </a>
  
    <nav class="md-nav" aria-label="Kitchen Sink">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#details-on-running-this-step-with-wrapper-scripts" class="md-nav__link">
    Details on running this step with wrapper scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#details-on-running-this-step-through-docker" class="md-nav__link">
    Details on running this step through docker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugins" class="md-nav__link">
    Plugins
  </a>
  
    <nav class="md-nav" aria-label="Plugins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastqtomappingplugin" class="md-nav__link">
    FastqToMappingPlugin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#besthaplotypepathplugin" class="md-nav__link">
    BestHaplotypePathPlugin
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_findPathKeyFiles/" class="md-nav__link">
        Find Path Key Files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_main/" class="md-nav__link">
        ImputeWithPHG main
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ImputeWithPHG_paramTuning/" class="md-nav__link">
        Tune pathfinding parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MakeDefaultDirectory/" class="md-nav__link">
        Make Default Directory Plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MakeInitialPHGDBPipeline/" class="md-nav__link">
        Make Initial PHG DB Pipeline Plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MergeFastqPluginDetailedDocs/" class="md-nav__link">
        MergeFastqPlugin Detailed Documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MultisampleBAMPipeline/" class="md-nav__link">
        Step 3a: Create ReadMappings using the MultisampleBAM Pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../PopulatePHGDBPipeline/" class="md-nav__link">
        Populate PHG DB Pipeline Plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../SampleHaplotypeConfigFile/" class="md-nav__link">
        Sample Config file for Loading Haplotypes.
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UpdatePHGSchema/" class="md-nav__link">
        Update an existing PHG database to latest schema with liquibase
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../help_biostars/" class="md-nav__link">
        How to ask questions about the PHG
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    Quick Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#details" class="md-nav__link">
    Details
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kitchen-sink" class="md-nav__link">
    Kitchen Sink
  </a>
  
    <nav class="md-nav" aria-label="Kitchen Sink">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#details-on-running-this-step-with-wrapper-scripts" class="md-nav__link">
    Details on running this step with wrapper scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#details-on-running-this-step-through-docker" class="md-nav__link">
    Details on running this step through docker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files" class="md-nav__link">
    Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugins" class="md-nav__link">
    Plugins
  </a>
  
    <nav class="md-nav" aria-label="Plugins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastqtomappingplugin" class="md-nav__link">
    FastqToMappingPlugin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#besthaplotypepathplugin" class="md-nav__link">
    BestHaplotypePathPlugin
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="impute-variants-from-any-fastq-file-process-for-homozygous-individuals">Impute variants from any fastq file - process for homozygous individuals</h1>
<h2 id="quick-start">Quick Start</h2>
<ol>
<li>Change <code>keyfile1</code>, <code>param2</code>, <code>param3</code>, and <code>param4</code> in your config file to match file paths on your computer.</li>
<li>Run <code>phg findPaths [config.txt]</code></li>
</ol>
<h2 id="details">Details</h2>
<p>This step uses the Minimap2 index and pangenome fasta files created in the previous step of the pipeline. It aligns a set of reads from an input fastq file to the graph and then uses an HMM to find the most likely path through the graph given the alignments. The database "paths" and "read_mapping_paths" tables are populated from the plugins called by this script.</p>
<h2 id="kitchen-sink">Kitchen Sink</h2>
<p>This step uses the pangenome fasta to find paths for new individuals. It requires a set of fastq reads. The type of sequencing data does not matter, but you should be working with fairly homozygous material. If you would like to run the findPaths step with heterozygous material, use the <a href="../ImputeWithPHG_fastq-heterozygous/">heterozygous findPaths</a> step.</p>
<p>This pipeline has two main steps:</p>
<ol>
<li>
<p>Run FastqToMappingPlugin to map a set of reads to the pangenome fasta file.  This plugin will make use of a keyfile and will store the mappings in the DB.</p>
</li>
<li>
<p>Run BestHaplotypePathPlugin to take the mappings from the DB and use a HMM to find the optimal path through the DB.  This will then store the paths into the DB.</p>
</li>
</ol>
<p>The findPaths pipeline requires the use of 2 keyfiles. The second is autogenerated, but could be changed if different results are desired.  Both files need to be tab-separated. If there are entries in the keyfile, but not found on the filesystem, the pipelines will skip over those entries. More information about these keyfiles can be found <a href="ImputeWithPHG_findPathKeyfiles.md">here</a>. </p>
<p>There are 8 parameters used in this step:</p>
<ul>
<li>BASE_HAPLOTYPE_NAME: This is the base of the name of the haplotype fasta file. This file should have been indexed in the previous step.</li>
<li>CONFIG_FILE_NAME: This is the path to the config.txt file used to create the DB. All the needed DB connection information should be in here.</li>
<li>HAPLOTYPE_METHOD: Method name of the haplotypes in the graph that were used to generate the haplotype fasta file in IndexPangenome.sh. This needs to match exactly otherwise the results will not be correct.</li>
<li>HAPLOTYPE_METHOD_FIND_PATH: This method can be the same as HAPLOTYPE_METHOD, but it is typically used to only include anchor reference ranges when running FindPath. Typically, finding paths through the interanchor reference ranges can cause additional errors. An example of what could be used here is this: HAPLOTYPE_METHOD,refRegionGroup to only include the refRegionGroup refRange group in the Graph used for finding the path.</li>
<li>HAPCOUNT_METHOD_NAME: Name of the Haplotype Mapping method used to upload the ReadMapping files to the DB. This is currently not used so a dummy value can be used. It will be implemented in the future.</li>
<li>PATH_METHOD_NAME: Name of the Path Mapping method used to upload the Paths to the DB. This method name will be used in the next step (<code>phg exportPath</code>) to extract out the paths from the DB.</li>
<li>READ_KEY_FILE: This name needs to match the name of the keyfile. This keyfile will describe what fastq files need to be aligned together and also denotes the required metadata fields which are stored in the DB.</li>
<li>PATH_KEY_FILE: This name is what the path finding keyfile will be named.  FastqToMappingPlugin will create this file and then BestHaplotypePathPlugin will use it to find paths. Note that FastqToMappingPlugin will group reads by taxon and all the mappings for a given taxon will be used when finding the paths.</li>
</ul>
<h3 id="details-on-running-this-step-with-wrapper-scripts"><em>Details on running this step with wrapper scripts</em></h3>
<p>When running this step on the command line, all file paths and parameters are set in the config file. The only call that needs to be run in the terminal is <code>phg findPath /path/to/config.txt</code>. If you would like to overwrite the parameters set in the config file, you can do that by setting the parameters on the command line directly.</p>
<p>For example, to ignore the config file HAPCOUNT_METHOD_NAME level and set one directly, you could run:</p>
<pre><code>phg findPaths -configFile /path/to/config.txt -HAPCOUNT_METHOD_NAME MyNewMethod1
</code></pre>
<p>You can also run the <code>FindPathMinimap2.sh</code> bash script directly with the following run command:</p>
<pre><code>#!bash

FindPathMinimap2.sh [BASE_HAPLOTYPE_NAME] [CONFIG_FILE_NAME] [HAPLOTYPE_METHOD] [HAPLOTYPE_METHOD_FIND_PATH] [HAPCOUNT_METHOD_NAME] [PATH_METHOD_NAME] [READ_KEY_FILE] [PATH_KEY_FILE]

</code></pre>
<h3 id="details-on-running-this-step-through-docker"><em>Details on running this step through docker</em></h3>
<p>When this step is run as part of a Docker container script, the Docker expect the following directory mount points: </p>
<ul>
<li>Mount localMachine:/pathToInputs/FastQFiles/ to docker:/tempFileDir/data/fastq</li>
<li>Mount localMachine:/pathToOutputs/ to docker:/tempFileDir/outputDir/</li>
<li>Mount localMachine:/pathToPangenomeIndex/ to docker:/tempFileDir/outputDir/pangenome/</li>
<li>Mount localMachine:/pathToInputs/config.txt to docker:/tempFileDir/data/config.txt</li>
<li>Mount localMachine:/pathToInputs/phg.db to docker:/tempFileDir/outputDir/phgTestMaizeDB.db.  This needs to match what is in the config file.</li>
</ul>
<p>It is expected the database is stored in the User specified outputDir that is mounted below and the config.txt specifies the database name and login parameters.</p>
<p><strong>It is critical that the .mmi file is mounted to /tempFileDir/outputDir/pangenome/ in the docker.  Otherwise this will not work correctly.</strong>  </p>
<p>An example Docker script to run the FindPathMinimap2.sh shell script is:</p>
<pre><code>#!bash
DB=/workdir/user/DockerTuningTests/DockerOutput/phgTestMaizeDB.db
PANGENOME_DIR=/workdir/user/DockerTuningTests/DockerOutput/PangenomeFasta/  

docker run --name small_seq_test_container --rm \ 
    -w / \
    -v /workdir/user/DockerTuningTests/DockerOutput/:/tempFileDir/outputDir/ \
    -v /workdir/user/DockerTuningTests/InputFiles/GBSFastq/:/tempFileDir/data/fastq/ \
    -v /workdir/user/DockerTuningTests/InputFiles/config.txt:/tempFileDir/data/configSQLite.txt \
    -v ${DB}:/tempFileDir/outputDir/phgTestMaizeDB.db \
    -v ${PANGENOME_DIR}:/tempFileDir/outputDir/pangenome/ \
    -t maizegenetics/phg:latest \
    /FindPathMinimap2.sh phgSmallSeqSequence configSQLite.txt \
        CONSENSUS CONSENSUS,refRegionGroup \
        HAP_COUNT_METHOD PATH_METHOD \
        /tempFileDir/data/fastq/genotypingKeyFile.txt \
        /tempFileDir/data/fastq/genotypingKeyFile_pathKeyFile.txt

</code></pre>
<p>PANGENOME_DIR must match the directory set in the IndexPangenome step.</p>
<p>The --name parameter provides a name for the container.  This is optional.</p>
<p>The --rm parameter indicates the container should be deleted when the program finishes executing.  This is optional.</p>
<p>Note the -w / parameter. This is needed to guarantee that the script will run correctly. When running a normal docker, this is likely not needed, but if running on a system like cbsu, the working directory needs to be set to the root directory.</p>
<p>The -v directives are used to mount data from the user machine into the Docker.  The path preceding the ":" is the path on the user machine.  The directory path following the ":" are the paths inside the Docker where the user home directories will be mounted.</p>
<p>The -t directive indicates the Docker image of which this container will be an instance.  The last line tells the Docker container to run the FindPath.sh script which is found in the root directory. The items following are the parameters to the FindPath.sh script.</p>
<h3 id="files"><em>Files</em></h3>
<p><strong>Config file</strong></p>
<p>An example can be found here: <a href="../Files/master_config.txt">Master config file</a></p>
<p><strong>Pangenome fasta file (with index)</strong></p>
<p>This is the pangenome fasta file created in the previous step. The name of that file should be the same as the value you set for the BASE_HAPLOTYPE_NAME parameter.</p>
<p><strong>Read key file</strong></p>
<p>Tab-delimited text file that sets up fastq alignment to the pangenome fasta. Has a header with "cultivar\tflowcell_lane\tfilename\tPlateID" and corresponding information for each fastq file used in the findPaths step. Only the first three columns are required. More information and an example are here: <a href="../ImputeWithPHG_findPathKeyFiles/">findPaths keyfiles</a></p>
<p><strong>Path key file</strong></p>
<p>This file is created automatically, so you will not need to create one on your own unless you would like to change some of the values in it. This file has three columns: "sampleName\tReadMappingIds\tLikelyParents". Only the first two columns are required. More information and an example are here: <a href="../ImputeWithPHG_findPathKeyFiles/">findPaths keyfiles</a></p>
<h3 id="plugins"><em>Plugins</em></h3>
<h4 id="fastqtomappingplugin"><strong>FastqToMappingPlugin</strong></h4>
<p>The FastqToMappingPlugin executes code to count the number of reads which align to a haplotype node using Minimap 2. </p>
<p>If running in paired mode, it will align the read pairs using minimap and process the resulting SAM records. Only equally optimal mappings (by Edit Distance (NM) are kept. Additional filtering is done to remove reads which are unmapped or clipped. </p>
<p>If running in paired mode, the reads must be on opposite strands and both must currently hit the same haplotype in a single reference range. Optimal mappins across reference ranges are processed, but reads are only assigned to haplotypes in the reference range with the most hits (providing that at least 1-maxRefRangeError percentage hit that reference range). Based on testing, this seems to work the best to balance the number of reads used with accuracy. The plugin requires a PHG Haplotype Graph, which can be acquired by chaining the running of HaplotypeGraphBuilderPlugin and this plugin. </p>
<p>The output from the HaplotypeGraphBuilderPlugin will be input to the BestHaplotypePathPlugin.</p>
<p>The parameters for this plugin are:</p>
<ul>
<li>-configFile <Config File> DB Config File containing properties host,user,password,DB and DBtype where DBtype is either sqlite or postgres (Default=null) (REQUIRED) A sample config file can be found here:<a href="../Files/master_config.txt">Master Config File</a>.</li>
<li>-minimap2IndexFile <Minimap2 index file for pangenome> : Name of the indexFile file to process (required)</li>
<li>-keyFile <keyFile> : Name of the Keyfile to process. Must have columns cultivar, flowcell_lane, filename, and PlateID. Optionally for paired end reads, filename2 is needed. If filename2 is not supplied, Minimap2 will run in single end mode. Otherwise will be paired. (required)</li>
<li>-fastqDir <Fastq dir to process> : Name of the Fastq dir to process. (required)</li>
<li>-maxRefRangeErr <Max Ref Range Err> : Maximum allowed error when choosing best reference range to count.  Error is computed 1 - (mostHitRefCount/totalHits) (Default: 0.25)</li>
<li>-lowMemMode <true | false> : Run in low memory mode. (Default: true)</li>
<li>-maxSecondary <Max Secondary> : Maximum number of secondary alignments to be returned by minimap2. This will be the value of the -N parameter in the minimap2 command line. If the value is too low, some valid read mappings will not be reported. (Default: 20)</li>
<li>-minimapLocation <Location of Minimap2 Executable> : Location of Minimap2 on file system.  This defaults to use minimap2 if it is on the PATH environment variable. (Default: minimap2)</li>
<li>-methodName <Method Name> : Method name to be stored in the DB. (required)</li>
<li>-methodDescription <Method Description> : Method description to be stored in the DB. (required)</li>
<li>-debugDir <Debug Directory to write out read Mapping files.> : Directory to write out the read mapping files.  This is optional for debug purposes. (Default: )</li>
<li>-outputSecondaryStats <true | false> : Ouptput Secondary Mapping Statistics such as total AS for each haplotype ID (Default: false)</li>
</ul>
<p>The FastqToMappingPlugin requires a haplotype graph, which can be obtained with the HaplotypeGraphBuilderPlugin. An example for chaining these plugins is below:</p>
<pre><code>perl /tassel-5-standalone/run_pipeline.pl -debug ${fullXmx} \
-configParameters ${CONFIGFILE} \
-HaplotypeGraphBuilderPlugin \
    -configFile ${CONFIGFILE} \
    -methods ${HAPLOTYPE_METHOD} \
    -includeVariantContexts false \
    -includeSequences false \
    -endPlugin \
-FastqToMappingPlugin \
    -minimap2IndexFile ${HAPLOTYPE_INDEX} \
    -keyFile ${KEY_FILE} \
    -fastqDir ${FASTQ_DIR}/ \
    -methodName ${HAP_COUNT_METHOD} \
    -methodDescription READ_MAPPING_DESCRIPTION \
    -debugDir $OUTPUT_DIR \
    -endPlugin
</code></pre>
<h4 id="besthaplotypepathplugin"><strong>BestHaplotypePathPlugin</strong></h4>
<p>This plugin takes a haplotype graph and a set of read mappings to infer the best (most likely) path through the graph given the read mappings. Read mappings are a list of reads with a set of haplotypes to which that read aligned. </p>
<p>The plugin can (1) take a file of read mappings and return a file with a list of haplotypes or (2) take read mappings from a PHG DB and store the resulting list of haplotypes in the DB.</p>
<p>If (1), the input is a file, then the plugin can take either a file or a directory containing multiple files. If a directory, all read mapping files will be processed and the haplotype lists output as separate files to an output directory. If the output directory is not specified, then the lists will be written to the input directory. Any path files of the same name will not be overwritten; a message will be written to the log to that effect, unless the "overwrite" flag is set to true.</p>
<p>If (2), the input comes from a PHG DB, an input read map method and the output path method must be supplied. In addition, a specific taxon or list of taxa for which paths are to be imputed can be suppled. If paths for any of the taxa and methods exist, the paths will not be imputed and a warning message will be written to the log file. If the "overwrite" flag is set to true, any existing paths will be overwritten and a message to that effect will be written to the log. </p>
<p>The parameters for this plugin are:</p>
<ul>
<li>-keyFile <Key File> : KeyFile file name.  Must be a tab separated file using the following headers: SampleName    ReadMappingIds  LikelyParents<ul>
<li>ReadMappingIds and LikelyParents need to be comma separated for multiple values (required)</li>
</ul>
</li>
<li>-readFile <Read Map File> : Filename of read mappings. Do not supply both a filename and a directory.</li>
<li>-readDir <Read Map Directory> : Directory of read mapping files. If this is supplied, do not also assign a read filename.</li>
<li>-outDir <Path Output Directory> : Directory to which path files will be written.</li>
<li>-readMethod <Read Mapping Method> : The name of the read mapping method in the PHG DB (required)</li>
<li>-pathMethod <Path Method> : The name of the path method used to write the results to the PHG DB (required)</li>
<li>-overwrite <true | false> : If an output pathfile already exists for a taxon, then it will be overwritten if overwrite = true. Otherwise, it will not and a warning will be written to the log. Likewise for paths in the PHG DB. (Default: false)</li>
<li>-minTaxa <Min Taxa> : minimum number of taxa per anchor reference range. Ranges with fewer taxa will not be included in the output node list. (Default: 20)</li>
<li>-minReads <Min Reads> : minimum number of reads per anchor reference range. Ranges with fewer reads will not be included in the output node list. (Default: 1)</li>
<li>-maxReads <Max Reads> : maximum number of include counts per anchor reference range Kb. Ranges with more reads will not be included in the output node list. (Default: 10000)</li>
<li>-maxNodes <Max Nodes> : maximum number of nodes per reference range. Ranges with more nodes will not be included in the output node list. (Default: 1000)</li>
<li>-minTransitionProb <Min Transition Prob> : minimum probability of a transition between nodes at adjacent reference ranges. (Default: 0.001)</li>
<li>-probCorrect <Prob Correct> : minimum number of reads per anchor reference range. Ranges with fewer reads will not be included in the output node list. (Default: 0.99)</li>
<li>-splitNodes <true | false> : split consensus nodes into one node per taxon. (Default: true)</li>
<li>-splitProb <Split Prob> : When the consensus nodes are split by taxa, this is the transition probability for moving from a node to the next node of the same taxon. It equals 1 minus the probability that the path will switch between taxa. (Default: 0.99)</li>
<li>-usebf <true | false> : Use the Backward-Forward algorithm instead of the Viterbi algorithm for the HMM. (Default: false)</li>
<li>-minP <Min P> : Only nodes with minP or greater probability will be kept in the path when using the Backward-Forward algorithm, (Default: 0.8)</li>
<li>-bfInfoFile <Bf Info File> : The base name of the file to node probabilities from the backward-forward algorithm will be written. taxonName.txt will be appended to each file.</li>
<li>-removeEqual <true | false> : Ranges with equal read counts for all haplotypes should be removed from the graph. Defaults to true but will be always be false if minReads = 0. (Default: true)</li>
<li>-numThreads <Num Threads> : Number of threads used to find paths. The path finding will subtract 2 from this number to have the number of worker threads.  It leaves 1 thread for IO to the DB and 1 thread for the Operating System. (Default: 3)</li>
<li>-requiredTaxa <Required Taxa> : Optional list of taxa required to have haplotypes. Any reference range that does not have a haplotype for one of these taxa will not be used for path finding. This can be a comma separated list of taxa (no spaces unless surrounded by quotes), file (.txt) with list of taxa names to include, or a taxa list file (.json or .json.gz). By default, all taxa will be included.</li>
<li>-algorithmType <Algorithm Type> : the type of algorithm. Choices are classic, which is the original implementation described by Rabiner 1989, or efficient, which is modified for improved computational efficiency. [classic, efficient] (Default: efficient)</li>
</ul>
<p>The BestHaplotypePathPlugin requires a haplotype graph, which can be obtained with the HaplotypeGraphBuilderPlugin. An example for chaining these plugins is below:</p>
<pre><code>/tassel-5-standalone/run_pipeline.pl -debug ${fullXmx} \
-configParameters ${CONFIGFILE} \
-HaplotypeGraphBuilderPlugin \
    -configFile ${CONFIGFILE} \
    -methods ${HAPLOTYPE_METHOD_FIND_PATH} \
    -includeVariantContexts false \
    -includeSequences false \
    -endPlugin \
-BestHaplotypePathPlugin \
    -keyFile ${PATH_KEY_FILE} \
    -outDir ${HAP_COUNT_BEST_PATH_DIR} \
    -readMethod ${HAP_COUNT_METHOD} \
    -pathMethod ${PATH_METHOD} \
    -endPlugin
</code></pre>
<h2 id="troubleshooting">Troubleshooting</h2>
<ol>
<li>If you see this error: ERROR net.maizegenetics.plugindef.AbstractPlugin - Haplotype count methodid not found in db for method : HAP_COUNT_METHOD, it means that something went wrong during the ReadMapping step.  Double check the -v parameters and make sure the mmi file is in /tempFileDir/outputDir/pangenome/</li>
</ol>
<p><a href="../ImputeWithPHG_main/">Return to Step 3 pipeline</a></p>
<p><a href="../Home.md">Return to Wiki Home</a></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>